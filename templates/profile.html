<script>
    function updateTextInput(el) {
        let currIdx = el.name - 1;
        document.getElementById('textInput' + '[' + currIdx + ']').value = el.value;
    }
</script>

{% extends "base.html" %}

{% block content %}
<h1 class="title" style="text-align: left">
    Hi, {{ name }}!
</h1>
<div class="col-md-12" style="text-align: left">
    <br/>
    <div>You have been assigned a total of <b>{{ max_points }}</b> points to distribute across <b>{{
        rotations|length}} </b>
        rotations
    </div>
    <br/>
    {% if points_results %}
    <div>Here are the most recent points you allocated:</div>
    <ul style="list-style: none;">
        {% for result in points_results %}
        <li>Rotation {{loop.index}}: <b>{{result}}</b></li>
        {% endfor %}
    </ul>
    {% endif %}
    <br/>
    {% if points_results %}
    <div>You can resubmit your allocations below until an official lottery has occurred</div>
    {% else %}
    <div>Please select below the points you would like to allocate for each rotation</div>
    {% endif %}
    <br/>
    <div class="input-group">
        <form name="{{name}}" action="/allocations" method="POST" enctype="multipart/form-data">
            {% for rotation in rotations %}
            <label for="pointsInput">Rotation {{ rotation }}:</label>
            {% if points_results %}
            <input type="range" name="{{rotation}}" id="pointsInput" value="{{points_results[loop.index -1]}}" min="1"
                   max="100" onchange="updateTextInput(this);"/>
            <input type="text" id="textInput{{[loop.index -1]}}" value="{{points_results[loop.index -1]}}"
                   style="background: none; border:none;color:white"/>
            <br/>
            {% else %}
            <input type="range" name="{{rotation}}" id="pointsInput" value="20" min="1"
                   max="100" onchange="updateTextInput(this);">
            <input type="text" id="textInput{{[loop.index -1]}}" value="20"
                   style="background: none; border:none;color:white">
            <br/>
            {% endif %}
            {% endfor %}
            <br/>
            <br/>
            <input type="submit"/>
        </form>
    </div>
</div>
{% endblock %}